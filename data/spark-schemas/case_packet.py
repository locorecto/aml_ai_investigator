from pyspark.sql.types import StructType, StructField, StringType, LongType, IntegerType, DoubleType, FloatType, BooleanType, ArrayType

SCHEMA = StructType([
    StructField("case_id", StringType(), True),
    StructField("party_id", StringType(), True),
    StructField("party_type", StringType(), True),
    StructField("party_name", StringType(), True),
    StructField("industry", StringType(), True),
    StructField("country", StringType(), True),
    StructField("state", StringType(), True),
    StructField("onboarding_date", StringType(), True),
    StructField("expected_monthly_volume_usd", DoubleType(), True),
    StructField("expected_avg_txn_usd", DoubleType(), True),
    StructField("risk_rating", StringType(), True),
    StructField("case_window_start_ms_utc", LongType(), True),
    StructField("case_window_end_ms_utc", LongType(), True),
    StructField("alerts_count", LongType(), True),
    StructField("alerts_high", LongType(), True),
    StructField("alerts_medium", LongType(), True),
    StructField("alerts_low", LongType(), True),
    StructField("max_risk_score", DoubleType(), True),
    StructField("median_risk_score", DoubleType(), True),
    StructField("model_types", ArrayType(StringType(), False), True),
    StructField("scenario_codes", ArrayType(StringType(), False), True),
    StructField("severities", ArrayType(StringType(), False), True),
    StructField("txn_count_case", LongType(), True),
    StructField("amount_total_usd_case", DoubleType(), True),
    StructField("median_amount_usd_case", DoubleType(), True),
    StructField("max_amount_usd_case", DoubleType(), True),
    StructField("first_txn_ms_utc_case", LongType(), True),
    StructField("last_txn_ms_utc_case", LongType(), True),
    StructField("intl_ratio_case", DoubleType(), True),
    StructField("instrument_types_case", ArrayType(StringType(), False), True),
    StructField("alerts", ArrayType(StructType([StructField("ts", LongType(), True), StructField("alert_id", StringType(), True), StructField("model_type", StringType(), True), StructField("scenario_code", StringType(), True), StructField("risk_score", DoubleType(), True), StructField("severity", StringType(), True), StructField("trigger_summary", StringType(), True), StructField("supporting_txn_ids", StringType(), True), StructField("amount_total_usd", DoubleType(), True), StructField("txn_count", IntegerType(), True), StructField("features_json", StringType(), True), StructField("data_quality_flags", StringType(), True)]), False), True),
    StructField("top_counterparties", ArrayType(StructType([StructField("amount_total_usd", DoubleType(), True), StructField("txn_count", LongType(), False), StructField("intl_ratio", DoubleType(), True), StructField("last_txn_ms_utc", LongType(), True), StructField("counterparty_id", StringType(), True), StructField("counterparty_type", StringType(), True), StructField("country", StringType(), True)]), False), True),
    StructField("top_merchants", ArrayType(StructType([StructField("amount_total_usd", DoubleType(), True), StructField("txn_count", LongType(), False), StructField("last_txn_ms_utc", LongType(), True), StructField("merchant_id", StringType(), True), StructField("merchant_name", StringType(), True), StructField("merchant_category", StringType(), True), StructField("country", StringType(), True), StructField("state", StringType(), True)]), False), True),
    StructField("supporting_transactions", ArrayType(StructType([StructField("ts", LongType(), True), StructField("txn_id", StringType(), True), StructField("instrument_type", StringType(), True), StructField("direction", StringType(), True), StructField("amount", DoubleType(), True), StructField("currency", StringType(), True), StructField("counterparty_id", StringType(), True), StructField("merchant_id", StringType(), True), StructField("channel", StringType(), True), StructField("country", StringType(), True), StructField("state", StringType(), True), StructField("is_international", IntegerType(), True), StructField("description", StringType(), True)]), False), True)
])
